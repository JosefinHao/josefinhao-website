{% extends "base.html" %}

{% block title %}Cat Cafe - Josefin Hao{% endblock %}

{% block body_attrs %} data-page="cat-cafe"{% endblock %}

{% block content %}
<div class="cat-cafe-container">
    <!-- Welcome message -->
    <div class="cat-cafe-intro">
        <h1>Welcome to the Cat Cafe</h1>
        <p>Play games to exercise the cat and earn points. Use points to feed the cat.</p>
    </div>

    <!-- Food Bowl Icon (Left Side) -->
    <div class="food-bowl-container">
        <button class="food-bowl-btn" id="foodBowlBtn" title="Feed Cat (10 points)">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="width: 60px; height: 60px;">
                <!-- Cat food bowl -->
                <defs>
                    <linearGradient id="bowlGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#FF6B9D;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#FF4081;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <!-- Bowl base shadow -->
                <ellipse cx="50" cy="85" rx="32" ry="5" fill="#000" opacity="0.2"/>
                <!-- Bowl outer rim -->
                <path d="M 20 40 L 25 75 Q 25 82, 32 85 L 68 85 Q 75 82, 75 75 L 80 40 Z"
                      fill="url(#bowlGradient)" stroke="#E63871" stroke-width="2"/>
                <!-- Bowl rim highlight -->
                <ellipse cx="50" cy="40" rx="30" ry="8" fill="#FFB3D1" opacity="0.6"/>
                <!-- Bowl inner -->
                <ellipse cx="50" cy="42" rx="28" ry="6" fill="#FF8FB3"/>
                <!-- Food in bowl -->
                <circle cx="45" cy="55" r="6" fill="#8B4513"/>
                <circle cx="55" cy="52" r="6" fill="#A0522D"/>
                <circle cx="50" cy="60" r="5" fill="#8B4513"/>
                <circle cx="42" cy="48" r="4" fill="#A0522D"/>
                <circle cx="58" cy="58" r="5" fill="#8B4513"/>
                <!-- Highlights on food -->
                <circle cx="47" cy="53" r="2" fill="#D2691E" opacity="0.6"/>
                <circle cx="56" cy="50" r="2" fill="#D2691E" opacity="0.6"/>
            </svg>
        </button>
        <div class="points-display">
            <span class="points-label">Points:</span>
            <span class="points-value" id="pointsDisplay">0</span>
        </div>
        <div class="size-display">
            <span class="size-label">Cat Size:</span>
            <span class="size-value" id="catSizeDisplay">1.0</span>
        </div>
    </div>

    <!-- Game Icons Container (Right Side) -->
    <div class="game-icons-right">
        <!-- Wand Game Icon -->
        <button class="game-icon-btn wand-game-btn" id="wandGameBtn" title="Play Wand Game">
            <img src="{{ url_for('static', filename='images/cat_teaser_wand.svg') }}" alt="Wand Game" style="width: 38px; height: 38px; object-fit: contain;">
        </button>

        <!-- Yarn Ball Game Icon -->
        <button class="game-icon-btn yarn-game-btn" id="yarnGameBtn" title="Play Yarn Ball Bounce">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="width: 60px; height: 60px;">
                <!-- Yarn ball -->
                <defs>
                    <radialGradient id="yarnGradient" cx="40%" cy="40%">
                        <stop offset="0%" style="stop-color:#FF9EC4;stop-opacity:1" />
                        <stop offset="50%" style="stop-color:#FF6B9D;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#E05588;stop-opacity:1" />
                    </radialGradient>
                </defs>
                <!-- Shadow -->
                <ellipse cx="52" cy="85" rx="25" ry="5" fill="#000" opacity="0.2"/>
                <!-- Ball base -->
                <circle cx="50" cy="50" r="32" fill="url(#yarnGradient)"/>
                <!-- Yarn strands wrapping around -->
                <path d="M 22 45 Q 35 42, 50 40 Q 65 42, 78 45" stroke="#FFB3D1" stroke-width="2.5" fill="none" opacity="0.8"/>
                <path d="M 25 55 Q 38 52, 50 50 Q 62 52, 75 55" stroke="#FF8FB3" stroke-width="2.5" fill="none" opacity="0.7"/>
                <path d="M 28 35 Q 40 33, 50 32 Q 60 33, 72 35" stroke="#FFD4E5" stroke-width="2" fill="none" opacity="0.6"/>
                <path d="M 30 65 Q 42 62, 50 61 Q 58 62, 70 65" stroke="#FF80AB" stroke-width="2.5" fill="none" opacity="0.7"/>
                <!-- Curved strands -->
                <path d="M 35 25 Q 45 28, 50 30" stroke="#FFB3D1" stroke-width="2" fill="none" opacity="0.6"/>
                <path d="M 65 25 Q 55 28, 50 30" stroke="#FF8FB3" stroke-width="2" fill="none" opacity="0.6"/>
                <path d="M 35 75 Q 45 72, 50 70" stroke="#FFD4E5" stroke-width="2" fill="none" opacity="0.6"/>
                <path d="M 65 75 Q 55 72, 50 70" stroke="#FF80AB" stroke-width="2" fill="none" opacity="0.6"/>
                <!-- Loose yarn strand -->
                <path d="M 78 48 Q 85 52, 88 58 Q 86 64, 82 68" stroke="#FF6B9D" stroke-width="2.5" fill="none" stroke-linecap="round" opacity="0.9"/>
                <path d="M 82 68 Q 78 72, 75 75" stroke="#FF6B9D" stroke-width="2" fill="none" stroke-linecap="round" opacity="0.8"/>
                <!-- Highlights -->
                <circle cx="38" cy="38" r="6" fill="#FFE4ED" opacity="0.7"/>
                <circle cx="42" cy="42" r="3" fill="#FFF" opacity="0.5"/>
            </svg>
        </button>

        <!-- Meow Melody Game Icon -->
        <button class="game-icon-btn melody-game-btn" id="melodyGameBtn" title="Play Meow Melody">
            <img src="{{ url_for('static', filename='images/music.png') }}" alt="Music Notes" style="width: 60px; height: 60px; object-fit: contain;">
        </button>
    </div>

    <!-- Message Display -->
    <div class="cafe-message" id="cafeMessage"></div>

    <!-- Main Canvas -->
    <canvas id="cat-cafe-canvas"></canvas>

    <!-- Wand Mini-Game Overlay -->
    <div class="wand-game-overlay" id="wandGameOverlay" style="display: none;">
        <div class="wand-game-modal">
            <button class="wand-game-close" id="wandGameClose">âœ•</button>

            <h2>ğŸ¾ Cat Wand Game</h2>
            <p class="wand-game-instructions">Click the wand before it disappears!</p>

            <div class="wand-game-stats">
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="wandScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Time</span>
                    <span class="stat-value" id="wandTime">30</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best</span>
                    <span class="stat-value" id="wandBest">0</span>
                </div>
            </div>

            <div class="wand-game-area" id="wandGameArea">
                <!-- Wand positions -->
                <div class="wand-position left" data-position="0"></div>
                <div class="wand-position middle" data-position="1"></div>
                <div class="wand-position right" data-position="2"></div>

                <!-- Wand element -->
                <div class="wand" id="wand" style="display: none;">
                    <img src="{{ url_for('static', filename='images/cat_teaser_wand.svg') }}" class="wand-image" alt="Cat Teaser Wand">
                </div>

                <!-- Cat paw -->
                <div class="cat-paw" id="catPaw">
                    <div class="paw-pad"></div>
                    <div class="paw-toe"></div>
                    <div class="paw-toe"></div>
                    <div class="paw-toe"></div>
                </div>
            </div>

            <button class="wand-game-start" id="wandGameStart">Start Game</button>

            <div class="wand-leaderboard">
                <h3>ğŸ† Leaderboard</h3>
                <ol id="wandLeaderboardList">
                    <li>No scores yet</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Yarn Ball Bounce Mini-Game Overlay -->
    <div class="yarn-game-overlay" id="yarnGameOverlay" style="display: none;">
        <div class="yarn-game-modal">
            <button class="yarn-game-close" id="yarnGameClose">âœ•</button>

            <h2>ğŸ§¶ Yarn Ball Bounce</h2>
            <p class="yarn-game-instructions">Click yarn balls to bat them away! Don't let them reach the bottom!</p>

            <div class="yarn-game-stats">
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="yarnScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Lives</span>
                    <span class="stat-value" id="yarnLives">3</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best</span>
                    <span class="stat-value" id="yarnBest">0</span>
                </div>
            </div>

            <canvas id="yarnCanvas" width="500" height="400"></canvas>

            <button class="yarn-game-start" id="yarnGameStart">Start Game</button>

            <div class="yarn-leaderboard">
                <h3>ğŸ† Leaderboard</h3>
                <ol id="yarnLeaderboardList">
                    <li>No scores yet</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Meow Melody Mini-Game Overlay -->
    <div class="melody-game-overlay" id="melodyGameOverlay" style="display: none;">
        <div class="melody-game-modal">
            <button class="melody-game-close" id="melodyGameClose">âœ•</button>

            <h2>ğŸµ Meow Melody</h2>
            <p class="melody-game-instructions">Watch the pattern, then repeat it!</p>

            <div class="melody-game-stats">
                <div class="stat-item">
                    <span class="stat-label">Round</span>
                    <span class="stat-value" id="melodyRound">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="melodyScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best</span>
                    <span class="stat-value" id="melodyBest">0</span>
                </div>
            </div>

            <div class="melody-game-area" id="melodyGameArea">
                <div class="melody-toys">
                    <div class="melody-toy ball" data-toy="0" data-sound="meow1">
                        <div class="toy-icon">ğŸ§¶</div>
                        <div class="toy-label">Yarn Ball</div>
                    </div>
                    <div class="melody-toy mouse" data-toy="1" data-sound="meow2">
                        <div class="toy-icon">ğŸ</div>
                        <div class="toy-label">Mouse</div>
                    </div>
                    <div class="melody-toy feather" data-toy="2" data-sound="meow3">
                        <div class="toy-icon">ğŸŒ¸</div>
                        <div class="toy-label">Butterfly</div>
                    </div>
                    <div class="melody-toy fish" data-toy="3" data-sound="meow4">
                        <div class="toy-icon">ğŸ </div>
                        <div class="toy-label">Fish</div>
                    </div>
                </div>
            </div>

            <button class="melody-game-start" id="melodyGameStart">Start Game</button>

            <div class="melody-leaderboard">
                <h3>ğŸ† Leaderboard</h3>
                <ol id="melodyLeaderboardList">
                    <li>No scores yet</li>
                </ol>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/cat-cafe-game.js') }}"></script>
{% endblock %}
