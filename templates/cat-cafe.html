{% extends "base.html" %}

{% block title %}Cat Cafe - Josefin Hao{% endblock %}

{% block body_attrs %} data-page="cat-cafe"{% endblock %}

{% block content %}
<div class="cat-cafe-container">
    <!-- Welcome message -->
    <div class="cat-cafe-intro">
        <h1>ğŸ± Welcome to the Cat Cafe</h1>
        <p>You are now a cute cat in a cozy cafe! Click anywhere to move, drag on walls to scratch, and explore the space.</p>
    </div>

    <!-- Game Icons Container -->
    <div class="game-icons-left">
        <!-- Wand Game Icon -->
        <button class="game-icon-btn wand-game-btn" id="wandGameBtn" title="Play Wand Game">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Stick -->
                <line x1="2" y1="22" x2="14" y2="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                <!-- Feathers -->
                <ellipse cx="16.5" cy="7.5" rx="3" ry="5" transform="rotate(-45 16.5 7.5)" fill="currentColor" opacity="0.7"/>
                <ellipse cx="18" cy="6" rx="2.5" ry="4.5" transform="rotate(-30 18 6)" fill="currentColor" opacity="0.5"/>
                <ellipse cx="15" cy="9" rx="2.5" ry="4.5" transform="rotate(-60 15 9)" fill="currentColor" opacity="0.6"/>
                <!-- String -->
                <path d="M14 10 Q16 8 17 7" stroke="currentColor" stroke-width="1" stroke-linecap="round" fill="none"/>
            </svg>
        </button>

        <!-- Yarn Ball Game Icon -->
        <button class="game-icon-btn yarn-game-btn" id="yarnGameBtn" title="Play Yarn Ball Bounce">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2"/>
                <path d="M4 12 Q8 8, 12 12 T20 12" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <path d="M12 4 Q8 8, 12 12 T12 20" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <circle cx="12" cy="12" r="2" fill="currentColor"/>
            </svg>
        </button>

        <!-- Meow Melody Game Icon -->
        <button class="game-icon-btn melody-game-btn" id="melodyGameBtn" title="Play Meow Melody">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 18V5L21 3V16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="6" cy="18" r="3" stroke="currentColor" stroke-width="2"/>
                <circle cx="18" cy="16" r="3" stroke="currentColor" stroke-width="2"/>
            </svg>
        </button>
    </div>

    <!-- Color Picker Icon -->
    <div class="color-picker-container">
        <button class="color-picker-btn" id="colorPickerBtn" title="Change wall color">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Palette shape -->
                <path d="M12 2C6.48 2 2 6.48 2 12C2 14.5 3 16.75 4.58 18.33C5.5 19.25 6.83 19.5 8 19.5C9.5 19.5 10.5 18.5 10.5 17C10.5 16.5 10.33 16.08 10.17 15.75C10 15.42 10 15 10 14.75C10 13.78 10.78 13 11.75 13H14C17.31 13 20 10.31 20 7C20 3.69 16.42 2 12 2Z" fill="currentColor" opacity="0.2"/>
                <path d="M12 2C6.48 2 2 6.48 2 12C2 14.5 3 16.75 4.58 18.33C5.5 19.25 6.83 19.5 8 19.5C9.5 19.5 10.5 18.5 10.5 17C10.5 16.5 10.33 16.08 10.17 15.75C10 15.42 10 15 10 14.75C10 13.78 10.78 13 11.75 13H14C17.31 13 20 10.31 20 7C20 3.69 16.42 2 12 2Z" stroke="currentColor" stroke-width="1.5"/>
                <!-- Paint colors -->
                <circle cx="7.5" cy="10" r="1.5" fill="currentColor"/>
                <circle cx="10.5" cy="7" r="1.5" fill="currentColor"/>
                <circle cx="14.5" cy="7" r="1.5" fill="currentColor"/>
                <circle cx="17" cy="10" r="1.5" fill="currentColor"/>
            </svg>
        </button>
        <input type="color" id="wallColorPicker" class="color-input" value="#f5e6d3">
    </div>

    <!-- Main Canvas -->
    <canvas id="cat-cafe-canvas"></canvas>

    <!-- Instructions -->
    <div class="cafe-instructions">
        <div class="instruction-item">ğŸ–±ï¸ Click to move</div>
        <div class="instruction-item">âœ¨ Drag on walls to scratch</div>
        <div class="instruction-item">ğŸ“¦ Click boxes to interact</div>
        <div class="instruction-item">ğŸŒ² Explore cat trees and walkways</div>
        <div class="instruction-item">ğŸ® Play 3 mini-games!</div>
    </div>

    <!-- Wand Mini-Game Overlay -->
    <div class="wand-game-overlay" id="wandGameOverlay" style="display: none;">
        <div class="wand-game-modal">
            <button class="wand-game-close" id="wandGameClose">âœ•</button>

            <h2>ğŸ¾ Cat Wand Game</h2>
            <p class="wand-game-instructions">Click the wand before it disappears!</p>

            <div class="wand-game-stats">
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="wandScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Time</span>
                    <span class="stat-value" id="wandTime">30</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best</span>
                    <span class="stat-value" id="wandBest">0</span>
                </div>
            </div>

            <div class="wand-game-area" id="wandGameArea">
                <!-- Wand positions -->
                <div class="wand-position left" data-position="0"></div>
                <div class="wand-position middle" data-position="1"></div>
                <div class="wand-position right" data-position="2"></div>

                <!-- Wand element -->
                <div class="wand" id="wand" style="display: none;">
                    <div class="wand-stick"></div>
                    <div class="wand-feather"></div>
                </div>

                <!-- Cat paw -->
                <div class="cat-paw" id="catPaw">
                    <div class="paw-pad"></div>
                    <div class="paw-toe"></div>
                    <div class="paw-toe"></div>
                    <div class="paw-toe"></div>
                </div>
            </div>

            <button class="wand-game-start" id="wandGameStart">Start Game</button>

            <div class="wand-leaderboard">
                <h3>ğŸ† Leaderboard</h3>
                <ol id="wandLeaderboardList">
                    <li>No scores yet</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Yarn Ball Bounce Mini-Game Overlay -->
    <div class="yarn-game-overlay" id="yarnGameOverlay" style="display: none;">
        <div class="yarn-game-modal">
            <button class="yarn-game-close" id="yarnGameClose">âœ•</button>

            <h2>ğŸ§¶ Yarn Ball Bounce</h2>
            <p class="yarn-game-instructions">Click yarn balls to bat them away! Don't let them reach the bottom!</p>

            <div class="yarn-game-stats">
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="yarnScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Lives</span>
                    <span class="stat-value" id="yarnLives">3</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best</span>
                    <span class="stat-value" id="yarnBest">0</span>
                </div>
            </div>

            <canvas id="yarnCanvas" width="500" height="400"></canvas>

            <button class="yarn-game-start" id="yarnGameStart">Start Game</button>

            <div class="yarn-leaderboard">
                <h3>ğŸ† Leaderboard</h3>
                <ol id="yarnLeaderboardList">
                    <li>No scores yet</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Meow Melody Mini-Game Overlay -->
    <div class="melody-game-overlay" id="melodyGameOverlay" style="display: none;">
        <div class="melody-game-modal">
            <button class="melody-game-close" id="melodyGameClose">âœ•</button>

            <h2>ğŸµ Meow Melody</h2>
            <p class="melody-game-instructions">Watch the pattern, then repeat it!</p>

            <div class="melody-game-stats">
                <div class="stat-item">
                    <span class="stat-label">Round</span>
                    <span class="stat-value" id="melodyRound">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="melodyScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Best</span>
                    <span class="stat-value" id="melodyBest">0</span>
                </div>
            </div>

            <div class="melody-game-area" id="melodyGameArea">
                <div class="melody-toys">
                    <div class="melody-toy ball" data-toy="0" data-sound="meow1">
                        <div class="toy-icon">ğŸ”´</div>
                        <div class="toy-label">Ball</div>
                    </div>
                    <div class="melody-toy mouse" data-toy="1" data-sound="meow2">
                        <div class="toy-icon">ğŸ­</div>
                        <div class="toy-label">Mouse</div>
                    </div>
                    <div class="melody-toy feather" data-toy="2" data-sound="meow3">
                        <div class="toy-icon">ğŸª¶</div>
                        <div class="toy-label">Feather</div>
                    </div>
                    <div class="melody-toy fish" data-toy="3" data-sound="meow4">
                        <div class="toy-icon">ğŸŸ</div>
                        <div class="toy-label">Fish</div>
                    </div>
                </div>
            </div>

            <button class="melody-game-start" id="melodyGameStart">Start Game</button>

            <div class="melody-leaderboard">
                <h3>ğŸ† Leaderboard</h3>
                <ol id="melodyLeaderboardList">
                    <li>No scores yet</li>
                </ol>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/cat-cafe-game.js') }}"></script>
{% endblock %}
