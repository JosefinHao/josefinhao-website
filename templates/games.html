{% extends "base.html" %}

{% block title %}Games - Josefin Hao{% endblock %}

{% block content %}
<div class="games-intro">
    <h1>üéÆ Developer Mini-Games</h1>
    <p style="color: #5f7c8a; font-size: 1rem; margin-bottom: 2rem;">
        Test your skills with these fun, interactive coding challenges!
    </p>
</div>

<!-- Grid of Game Cards -->
<div class="games-grid">
    <!-- Game 1: Typing Speed Challenge -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>‚å®Ô∏è Typing Speed Challenge</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Type code snippets as fast and accurately as you can. Test your coding speed with real Python and SQL code!
        </p>
        <button class="game-launch-btn" onclick="openGameModal('typing-game-modal')">
            Play Now
        </button>
    </div>

    <!-- Game 2: Guess the Output -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>üîÆ Guess the Output</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Look at Python or SQL code and predict what it will output. Perfect for testing your code comprehension!
        </p>
        <button class="game-launch-btn" onclick="openGameModal('guess-game-modal')">
            Play Now
        </button>
    </div>

    <!-- Game 3: Big O Challenge -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>üìä Big O Challenge</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Identify the time and space complexity of code snippets. Master Big O notation like a pro!
        </p>
        <button class="game-launch-btn" onclick="openGameModal('bigo-game-modal')">
            Play Now
        </button>
    </div>
</div>

<!-- Modal 1: Typing Speed Game -->
<div id="typing-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>‚å®Ô∏è Typing Speed Challenge</h2>
            <button class="game-modal-close" onclick="closeGameModal('typing-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Type the code snippet as fast and accurately as you can!
            </p>

            <div class="typing-game-area">
                <div class="snippet-container">
                    <pre id="snippet-display" class="snippet-display">Click "Start New Challenge" to begin!</pre>
                </div>

                <textarea
                    id="user-input"
                    class="typing-input"
                    placeholder="Type the code here..."
                    disabled
                    spellcheck="false"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                ></textarea>

                <div class="typing-controls">
                    <button id="start-typing-btn" class="typing-btn typing-btn-primary">Start New Challenge</button>
                    <button id="reset-typing-btn" class="typing-btn typing-btn-secondary" disabled>Reset</button>
                </div>

                <div id="typing-results" class="typing-results"></div>
            </div>

            <div class="leaderboard-section">
                <h4 style="margin-bottom: 0.75rem; color: #2c3e50;">üèÜ Leaderboard (Top 10)</h4>
                <div id="typing-leaderboard"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 2: Guess the Output Game -->
<div id="guess-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>üîÆ Guess the Output</h2>
            <button class="game-modal-close" onclick="closeGameModal('guess-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Read the code carefully and select the correct output!
            </p>

            <div class="guess-game-area">
                <div class="guess-controls">
                    <label for="guess-difficulty" style="font-weight: 600; color: #2c3e50;">Difficulty:</label>
                    <select id="guess-difficulty" class="guess-difficulty-select">
                        <option value="easy">Easy</option>
                        <option value="medium">Medium</option>
                        <option value="hard">Hard</option>
                        <option value="all">All Levels</option>
                    </select>
                    <button id="start-guess-btn" class="typing-btn typing-btn-primary">Start Quiz</button>
                    <span id="guess-score" class="guess-score">Score: 0/0</span>
                </div>

                <div id="guess-code-display" class="guess-code-display"></div>
                <div id="guess-options" class="guess-options-container"></div>
                <div id="guess-result" class="guess-result"></div>

                <div class="typing-controls" style="margin-top: 1rem;">
                    <button id="next-guess-btn" class="typing-btn typing-btn-primary" disabled>Next Question</button>
                </div>
            </div>

            <div class="leaderboard-section">
                <h4 style="margin-bottom: 0.75rem; color: #2c3e50;">üèÜ Leaderboard (Top 10)</h4>
                <div id="guess-leaderboard"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 3: Big O Challenge Game -->
<div id="bigo-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>üìä Big O Challenge</h2>
            <button class="game-modal-close" onclick="closeGameModal('bigo-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Analyze the algorithm and identify its complexity!
            </p>

            <div class="guess-game-area">
                <div class="guess-controls">
                    <button id="start-bigo-btn" class="typing-btn typing-btn-primary">Start Challenge</button>
                    <span id="bigo-score" class="guess-score">Score: 0/0</span>
                </div>

                <div id="bigo-complexity-type" style="margin-bottom: 1rem;"></div>
                <div id="bigo-code-display" class="guess-code-display"></div>
                <div id="bigo-options" class="guess-options-container"></div>
                <div id="bigo-result" class="guess-result"></div>

                <div class="typing-controls" style="margin-top: 1rem;">
                    <button id="next-bigo-btn" class="typing-btn typing-btn-primary" disabled>Next Question</button>
                </div>
            </div>

            <div class="leaderboard-section">
                <h4 style="margin-bottom: 0.75rem; color: #2c3e50;">üèÜ Leaderboard (Top 10)</h4>
                <div id="bigo-leaderboard"></div>
            </div>
        </div>
    </div>
</div>

<script>
// Open game modal
function openGameModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }
}

// Close game modal
function closeGameModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto'; // Restore scrolling
    }
}

// Close modal when clicking outside of it
window.onclick = function(event) {
    if (event.target.classList.contains('game-modal')) {
        event.target.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

// Close modal on ESC key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const modals = document.querySelectorAll('.game-modal');
        modals.forEach(modal => {
            if (modal.style.display === 'flex') {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });
    }
});
</script>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/typing-game.js') }}"></script>
<script src="{{ url_for('static', filename='js/guess-output-game.js') }}"></script>
<script src="{{ url_for('static', filename='js/bigo-game.js') }}"></script>
{% endblock %}
