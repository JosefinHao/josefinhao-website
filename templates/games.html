{% extends "base.html" %}

{% block title %}Games - Josefin Hao{% endblock %}

{% block content %}
<div class="games-intro">
    <h1>üéÆ Developer Mini-Games</h1>
    <p style="color: #5f7c8a; font-size: 1rem; margin-bottom: 2rem;">
        Test your skills with these fun, interactive coding challenges!
    </p>
</div>

<!-- Grid of Game Cards -->
<div class="games-grid">
    <!-- Game 1: Typing Speed Challenge -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>‚å®Ô∏è Typing Speed Challenge</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Type code snippets as fast and accurately as you can. Test your coding speed with real Python and SQL code!
        </p>
        <button class="game-launch-btn" onclick="openGameModal('typing-game-modal')">
            Play Now
        </button>
    </div>

    <!-- Game 2: Guess the Output -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>üîÆ Guess the Output</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Look at Python or SQL code and predict what it will output. Perfect for testing your code comprehension!
        </p>
        <button class="game-launch-btn" onclick="openGameModal('guess-game-modal')">
            Play Now
        </button>
    </div>

    <!-- Game 3: Big O Challenge -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>üìä Big O Challenge</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Identify the time and space complexity of code snippets. Master Big O notation like a pro!
        </p>
        <button class="game-launch-btn" onclick="openGameModal('bigo-game-modal')">
            Play Now
        </button>
    </div>

    <!-- Game 4: Neural Network Playground -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>üß† Neural Network Playground</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Train a neural network by tuning hyperparameters! Watch decision boundaries form in real-time as you master deep learning fundamentals.
        </p>
        <button class="game-launch-btn" onclick="openGameModal('nn-game-modal')">
            Play Now
        </button>
    </div>

    <!-- Game 5: Blockchain Mining Simulator -->
    <div class="game-card">
        <div class="game-card-header">
            <h3>‚õèÔ∏è Blockchain Mining Simulator</h3>
            <span class="game-badge">Active</span>
        </div>
        <p class="game-description">
            Experience proof-of-work mining! Find nonces that produce valid hashes and understand blockchain security fundamentals.
        </p>
        <button class="game-launch-btn" onclick="openGameModal('blockchain-game-modal')">
            Play Now
        </button>
    </div>
</div>

<!-- Modal 1: Typing Speed Game -->
<div id="typing-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>‚å®Ô∏è Typing Speed Challenge</h2>
            <button class="game-modal-close" onclick="closeGameModal('typing-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Type the code snippet as fast and accurately as you can!
            </p>

            <div class="typing-game-area">
                <div class="snippet-container">
                    <pre id="snippet-display" class="snippet-display">Click "Start New Challenge" to begin!</pre>
                </div>

                <textarea
                    id="user-input"
                    class="typing-input"
                    placeholder="Type the code here..."
                    disabled
                    spellcheck="false"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                ></textarea>

                <div class="typing-controls">
                    <button id="start-typing-btn" class="typing-btn typing-btn-primary">Start New Challenge</button>
                    <button id="reset-typing-btn" class="typing-btn typing-btn-secondary" disabled>Reset</button>
                </div>

                <div id="typing-results" class="typing-results"></div>
            </div>

            <div class="leaderboard-section">
                <h4 style="margin-bottom: 0.75rem; color: #2c3e50;">üèÜ Leaderboard (Top 10)</h4>
                <div id="typing-leaderboard"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 2: Guess the Output Game -->
<div id="guess-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>üîÆ Guess the Output</h2>
            <button class="game-modal-close" onclick="closeGameModal('guess-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Read the code carefully and select the correct output!
            </p>

            <div class="guess-game-area">
                <div class="guess-controls">
                    <label for="guess-difficulty" style="font-weight: 600; color: #2c3e50;">Difficulty:</label>
                    <select id="guess-difficulty" class="guess-difficulty-select">
                        <option value="easy">Easy</option>
                        <option value="medium">Medium</option>
                        <option value="hard">Hard</option>
                        <option value="all">All Levels</option>
                    </select>
                    <button id="start-guess-btn" class="typing-btn typing-btn-primary">Start Quiz</button>
                    <span id="guess-score" class="guess-score">Score: 0/0</span>
                </div>

                <div id="guess-code-display" class="guess-code-display"></div>
                <div id="guess-options" class="guess-options-container"></div>
                <div id="guess-result" class="guess-result"></div>

                <div class="typing-controls" style="margin-top: 1rem;">
                    <button id="next-guess-btn" class="typing-btn typing-btn-primary" disabled>Next Question</button>
                </div>
            </div>

            <div class="leaderboard-section">
                <h4 style="margin-bottom: 0.75rem; color: #2c3e50;">üèÜ Leaderboard (Top 10)</h4>
                <div id="guess-leaderboard"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 3: Big O Challenge Game -->
<div id="bigo-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>üìä Big O Challenge</h2>
            <button class="game-modal-close" onclick="closeGameModal('bigo-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Analyze the algorithm and identify its complexity!
            </p>

            <div class="guess-game-area">
                <div class="guess-controls">
                    <button id="start-bigo-btn" class="typing-btn typing-btn-primary">Start Challenge</button>
                    <span id="bigo-score" class="guess-score">Score: 0/0</span>
                </div>

                <div id="bigo-complexity-type" style="margin-bottom: 1rem;"></div>
                <div id="bigo-code-display" class="guess-code-display"></div>
                <div id="bigo-options" class="guess-options-container"></div>
                <div id="bigo-result" class="guess-result"></div>

                <div class="typing-controls" style="margin-top: 1rem;">
                    <button id="next-bigo-btn" class="typing-btn typing-btn-primary" disabled>Next Question</button>
                </div>
            </div>

            <div class="leaderboard-section">
                <h4 style="margin-bottom: 0.75rem; color: #2c3e50;">üèÜ Leaderboard (Top 10)</h4>
                <div id="bigo-leaderboard"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 4: Neural Network Playground -->
<div id="nn-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>üß† Neural Network Playground</h2>
            <button class="game-modal-close" onclick="closeGameModal('nn-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Configure network architecture and hyperparameters to train on different datasets!
            </p>

            <div class="nn-game-area">
                <div class="nn-controls-panel">
                    <div class="nn-control-section">
                        <h4>Dataset</h4>
                        <select id="nn-dataset" class="nn-select">
                            <option value="xor">XOR Pattern</option>
                            <option value="circle">Circle</option>
                            <option value="spiral">Spiral</option>
                            <option value="gaussian">Gaussian Clusters</option>
                        </select>
                    </div>

                    <div class="nn-control-section">
                        <h4>Architecture</h4>
                        <label>Hidden Layers: <span id="nn-layers-value">2</span></label>
                        <input type="range" id="nn-layers" min="1" max="3" value="2" class="nn-slider">

                        <label>Neurons per Layer: <span id="nn-neurons-value">4</span></label>
                        <input type="range" id="nn-neurons" min="2" max="8" value="4" class="nn-slider">
                    </div>

                    <div class="nn-control-section">
                        <h4>Hyperparameters</h4>
                        <label>Learning Rate: <span id="nn-lr-value">0.1</span></label>
                        <input type="range" id="nn-lr" min="0.001" max="1" step="0.001" value="0.1" class="nn-slider">

                        <label>Activation Function:</label>
                        <select id="nn-activation" class="nn-select">
                            <option value="relu">ReLU</option>
                            <option value="sigmoid">Sigmoid</option>
                            <option value="tanh">Tanh</option>
                        </select>
                    </div>

                    <div class="nn-control-section">
                        <div class="typing-controls">
                            <button id="nn-train-btn" class="typing-btn typing-btn-primary">Start Training</button>
                            <button id="nn-pause-btn" class="typing-btn typing-btn-secondary" disabled>Pause</button>
                            <button id="nn-reset-btn" class="typing-btn typing-btn-secondary">Reset</button>
                        </div>
                    </div>

                    <div class="nn-stats">
                        <div class="nn-stat-item">
                            <span class="nn-stat-label">Epoch:</span>
                            <span id="nn-epoch-display" class="nn-stat-value">0</span>
                        </div>
                        <div class="nn-stat-item">
                            <span class="nn-stat-label">Accuracy:</span>
                            <span id="nn-accuracy-display" class="nn-stat-value">0%</span>
                        </div>
                        <div class="nn-stat-item">
                            <span class="nn-stat-label">Loss:</span>
                            <span id="nn-loss-display" class="nn-stat-value">0.00</span>
                        </div>
                    </div>
                </div>

                <div class="nn-visualization-panel">
                    <div class="nn-canvas-container">
                        <h4>Decision Boundary</h4>
                        <canvas id="nn-canvas" width="400" height="400"></canvas>
                    </div>

                    <div class="nn-chart-container">
                        <h4>Training Progress</h4>
                        <canvas id="nn-loss-chart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 5: Blockchain Mining Simulator -->
<div id="blockchain-game-modal" class="game-modal">
    <div class="game-modal-content">
        <div class="game-modal-header">
            <h2>‚õèÔ∏è Blockchain Mining Simulator</h2>
            <button class="game-modal-close" onclick="closeGameModal('blockchain-game-modal')">&times;</button>
        </div>
        <div class="game-modal-body">
            <p style="margin-bottom: 1.5rem; color: #5f7c8a; font-size: 1rem;">
                Mine blocks by finding nonces that produce hashes with required leading zeros!
            </p>

            <div class="blockchain-game-area">
                <div class="blockchain-controls-panel">
                    <div class="blockchain-control-section">
                        <h4>Mining Configuration</h4>
                        <label>Difficulty (Leading Zeros): <span id="blockchain-difficulty-value">2</span></label>
                        <input type="range" id="blockchain-difficulty" min="1" max="5" value="2" class="nn-slider">

                        <div class="typing-controls" style="margin-top: 1rem;">
                            <button id="blockchain-mine-btn" class="typing-btn typing-btn-primary">Start Mining</button>
                            <button id="blockchain-reset-btn" class="typing-btn typing-btn-secondary">Reset Chain</button>
                        </div>
                    </div>

                    <div class="blockchain-stats">
                        <div class="blockchain-stat-item">
                            <span class="blockchain-stat-label">Chain Length:</span>
                            <span id="blockchain-length-display" class="blockchain-stat-value">1</span>
                        </div>
                        <div class="blockchain-stat-item">
                            <span class="blockchain-stat-label">Attempts:</span>
                            <span id="blockchain-attempts-display" class="blockchain-stat-value">0</span>
                        </div>
                        <div class="blockchain-stat-item">
                            <span class="blockchain-stat-label">Hash Rate:</span>
                            <span id="blockchain-hashrate-display" class="blockchain-stat-value">0 H/s</span>
                        </div>
                        <div class="blockchain-stat-item">
                            <span class="blockchain-stat-label">Total Reward:</span>
                            <span id="blockchain-reward-display" class="blockchain-stat-value">0 BTC</span>
                        </div>
                    </div>

                    <div class="blockchain-info-section">
                        <h4>üìö How It Works</h4>
                        <p style="font-size: 0.9rem; color: var(--text-dark); line-height: 1.6;">
                            <strong>Proof-of-Work Mining:</strong><br>
                            Miners try different nonces until they find one that produces a hash starting with the required number of zeros. Higher difficulty = more zeros = exponentially harder!
                        </p>
                    </div>
                </div>

                <div class="blockchain-visualization-panel">
                    <div class="blockchain-current-block">
                        <h4>‚õèÔ∏è Current Mining Block</h4>
                        <div class="blockchain-block-data">
                            <div class="blockchain-field">
                                <span class="blockchain-field-label">Block #:</span>
                                <span id="blockchain-block-number">1</span>
                            </div>
                            <div class="blockchain-field">
                                <span class="blockchain-field-label">Previous Hash:</span>
                                <code id="blockchain-prev-hash">0000000...</code>
                            </div>
                            <div class="blockchain-field">
                                <span class="blockchain-field-label">Data:</span>
                                <span id="blockchain-data">Genesis Block</span>
                            </div>
                            <div class="blockchain-field">
                                <span class="blockchain-field-label">Nonce:</span>
                                <span id="blockchain-nonce">0</span>
                            </div>
                            <div class="blockchain-field">
                                <span class="blockchain-field-label">Hash:</span>
                                <code id="blockchain-hash" class="blockchain-hash-invalid">Searching...</code>
                            </div>
                        </div>
                    </div>

                    <div class="blockchain-chain-container">
                        <h4>‚õìÔ∏è Blockchain</h4>
                        <div id="blockchain-chain" class="blockchain-chain-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Open game modal
function openGameModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'flex';
        // Scroll the modal overlay to the top to ensure content is visible
        modal.scrollTop = 0;
        document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }
}

// Close game modal
function closeGameModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto'; // Restore scrolling
    }
}

// Close modal when clicking outside of it
window.onclick = function(event) {
    if (event.target.classList.contains('game-modal')) {
        event.target.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

// Close modal on ESC key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const modals = document.querySelectorAll('.game-modal');
        modals.forEach(modal => {
            if (modal.style.display === 'flex') {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });
    }
});
</script>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/typing-game.js') }}"></script>
<script src="{{ url_for('static', filename='js/guess-output-game.js') }}"></script>
<script src="{{ url_for('static', filename='js/bigo-game.js') }}"></script>
<script src="{{ url_for('static', filename='js/neural-network-game.js') }}"></script>
<script src="{{ url_for('static', filename='js/blockchain-game.js') }}"></script>
{% endblock %}
